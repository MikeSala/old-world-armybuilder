<IfModule mod_rewrite.c>
  RewriteEngine On

  # Redirect root to the default locale.
  RewriteRule ^$ /pl/ [R=301,L]

  # Keep locale URLs clean by forcing trailing slashes.
  RewriteRule ^(pl|en|de|fr|es)\.html$ $1/ [R=301,L]
  RewriteRule ^(pl|en|de|fr|es)$ $1/ [R=301,L]
</IfModule>

# Compress text-based assets (JS, CSS, HTML, JSON, SVG, RSC payloads).
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/css text/plain text/xml
  AddOutputFilterByType DEFLATE application/javascript application/json
  AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# Browser cache: hashed static assets are immutable.
<IfModule mod_expires.c>
  ExpiresActive On

  # _next/static/ files have content hashes â€” cache for 1 year.
  <FilesMatch "\.(js|css)$">
    ExpiresDefault "access plus 1 year"
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

  # HTML and RSC payloads should revalidate on each visit.
  <FilesMatch "\.(html|txt)$">
    ExpiresDefault "access plus 0 seconds"
    Header set Cache-Control "public, max-age=0, must-revalidate"
  </FilesMatch>

  # Images and fonts: cache for 1 month.
  <FilesMatch "\.(webp|png|jpg|jpeg|gif|ico|woff2|woff)$">
    ExpiresDefault "access plus 1 month"
    Header set Cache-Control "public, max-age=2592000"
  </FilesMatch>
</IfModule>
